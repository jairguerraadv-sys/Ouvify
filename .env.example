# ==========================================
# .env.example - Ouvify
# Atualizado: 2026-01-26 (Auditoria Fase 1)
# ==========================================

# ==========================================
# DJANGO CORE
# ==========================================
SECRET_KEY=django-insecure-CHANGE-THIS-IN-PRODUCTION-use-python-secrets-token-urlsafe-50
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1,.railway.app,.vercel.app

# ==========================================
# DATABASE - PostgreSQL (Railway)
# ==========================================
# Railway fornece automaticamente estas variáveis
# Use DATABASE_PRIVATE_URL para melhor performance (rede privada)
DATABASE_PRIVATE_URL=postgresql://user:password@postgres.railway.internal:5432/ouvify_db
DATABASE_URL=postgresql://user:password@monorail.proxy.rlwy.net:12345/ouvify_db

# Desenvolvimento local: deixe vazio para usar SQLite
# DATABASE_PRIVATE_URL=
# DATABASE_URL=

# Pool de conexões (opcional - se usar pgbouncer)
DATABASE_POOL_MODE=transaction

# ==========================================
# JWT AUTHENTICATION
# ==========================================
# Se usar chave diferente para JWT (recomendado)
JWT_SECRET_KEY=jwt-secret-CHANGE-THIS-use-python-secrets-token-urlsafe-64
JWT_ACCESS_TOKEN_LIFETIME=15  # minutos
JWT_REFRESH_TOKEN_LIFETIME=7  # dias
JWT_ROTATE_REFRESH_TOKENS=True
JWT_BLACKLIST_AFTER_ROTATION=True

# ==========================================
# CORS - Frontend Origins
# ==========================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,https://ouvify.vercel.app,https://ouvify-saas.vercel.app
CORS_ALLOW_CREDENTIALS=True

# ==========================================
# REDIS - Cache & Celery
# ==========================================
# Railway fornece automaticamente
REDIS_URL=redis://red-xxxxx.railway.app:6379/0
# Desenvolvimento local:
# REDIS_URL=redis://localhost:6379/0

REDIS_CACHE_DB=0
REDIS_CELERY_DB=1

# ==========================================
# CELERY - Task Queue
# ==========================================
CELERY_BROKER_URL=${REDIS_URL}
CELERY_RESULT_BACKEND=${REDIS_URL}
CELERY_TASK_ALWAYS_EAGER=False  # True apenas em testes

# ==========================================
# CLOUDINARY - Upload de Imagens
# ==========================================
CLOUDINARY_CLOUD_NAME=your-cloud-name
CLOUDINARY_API_KEY=123456789012345
CLOUDINARY_API_SECRET=your-api-secret
CLOUDINARY_FOLDER=ouvify-production  # Mudar para staging/dev conforme ambiente

# ==========================================
# STRIPE - Pagamentos
# ==========================================
# Obtenha suas chaves em: https://dashboard.stripe.com/apikeys
STRIPE_SECRET_KEY=sk_test_your_secret_key_here
STRIPE_PUBLIC_KEY=pk_test_your_public_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# IDs dos Prices do Stripe (criar no dashboard)
STRIPE_PRICE_ID_STARTER=price_xxxxxxxxxxxxxxxxxxxxxx
STRIPE_PRICE_ID_PRO=price_xxxxxxxxxxxxxxxxxxxxxx

# URL de retorno após checkout
STRIPE_SUCCESS_URL=https://ouvify.vercel.app/dashboard?payment=success
STRIPE_CANCEL_URL=https://ouvify.vercel.app/cadastro?payment=canceled

# ==========================================
# EMAIL - SMTP
# ==========================================
EMAIL_BACKEND=django.core.mail.backends.smtp.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=noreply@ouvify.com
EMAIL_HOST_PASSWORD=your-app-password
DEFAULT_FROM_EMAIL=Ouvify <noreply@ouvify.com>

# Desenvolvimento: Console backend (printa emails no terminal)
# EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend

# ==========================================
# SENTRY - Error Tracking & Monitoring
# ==========================================
# Backend (Django)
SENTRY_DSN=https://xxxxxx@oxxxxxx.ingest.sentry.io/xxxxxx
SENTRY_ENVIRONMENT=production  # production, staging, development
SENTRY_TRACES_SAMPLE_RATE=0.1  # 10% das transações
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Frontend (Next.js)
NEXT_PUBLIC_SENTRY_DSN=https://xxxxxx@oxxxxxx.ingest.sentry.io/xxxxxx
SENTRY_AUTH_TOKEN=sntrys_xxxxxxxxxxxxxxxxxxxxxx  # Para upload de sourcemaps

# ==========================================
# ELASTICSEARCH - Busca
# ==========================================
ELASTICSEARCH_HOST=http://localhost:9200
ELASTICSEARCH_USER=elastic
ELASTICSEARCH_PASSWORD=changeme
ELASTICSEARCH_INDEX_PREFIX=ouvify

# Railway/Cloud (se usar Elastic Cloud):
# ELASTICSEARCH_HOST=https://xxxxx.es.us-central1.gcp.cloud.es.io:9243

# ==========================================
# VAPID - Push Notifications (Web Push)
# ==========================================
# Gerar com: python manage.py generate_vapid_keys
VAPID_PUBLIC_KEY=Bxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
VAPID_PRIVATE_KEY=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
VAPID_ADMIN_EMAIL=mailto:admin@ouvify.com

# ==========================================
# FRONTEND (Next.js) - Variáveis Públicas
# ==========================================
# Todas as variáveis com NEXT_PUBLIC_ são expostas ao navegador
NEXT_PUBLIC_API_URL=https://ouvify-saas-production.up.railway.app
NEXT_PUBLIC_SITE_URL=https://ouvify.vercel.app
NEXT_PUBLIC_SITE_NAME=Ouvify
NEXT_PUBLIC_VAPID_PUBLIC_KEY=${VAPID_PUBLIC_KEY}

# Stripe (frontend)
NEXT_PUBLIC_STRIPE_PUBLIC_KEY=${STRIPE_PUBLIC_KEY}

# Analytics (opcional)
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ==========================================
# NEXTAUTH (Se usar next-auth no futuro)
# ==========================================
NEXTAUTH_URL=https://ouvify.vercel.app
NEXTAUTH_SECRET=nextauth-secret-CHANGE-THIS-use-openssl-rand-base64-32

# ==========================================
# FEATURE FLAGS
# ==========================================
FEATURE_2FA_ENABLED=True
FEATURE_ELASTICSEARCH_ENABLED=True
FEATURE_PUSH_NOTIFICATIONS_ENABLED=True
FEATURE_ANALYTICS_ENABLED=True
FEATURE_MAINTENANCE_MODE=False

# ==========================================
# SECURITY
# ==========================================
SECURE_SSL_REDIRECT=True  # False em desenvolvimento
SESSION_COOKIE_SECURE=True  # False em desenvolvimento
CSRF_COOKIE_SECURE=True  # False em desenvolvimento
SECURE_HSTS_SECONDS=31536000  # 1 ano
SECURE_HSTS_INCLUDE_SUBDOMAINS=True
SECURE_HSTS_PRELOAD=True

# ==========================================
# PERFORMANCE
# ==========================================
CONN_MAX_AGE=600  # Segundos de conexão persistente ao DB
CACHE_TTL=3600  # TTL padrão do cache (1 hora)

# ==========================================
# LOGGING
# ==========================================
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
DJANGO_LOG_LEVEL=INFO

# ==========================================
# DESENVOLVIMENTO
# ==========================================
# Desabilitar telemetria do Next.js
NEXT_TELEMETRY_DISABLED=1

# Modo de desenvolvimento do Next.js
NODE_ENV=development  # development, production

# ==========================================
# TESTES
# ==========================================
# Configurações específicas para testes (usar em CI/CD)
TESTING=False
TEST_DATABASE_URL=postgresql://localhost:5432/ouvify_test
# CELERY_TASK_ALWAYS_EAGER=True  # Executa tasks síncronamente em testes
